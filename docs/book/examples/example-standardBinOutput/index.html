<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="None">
        <meta name="author" content="Logimic">
        <link rel="canonical" href="http://logimic.com/iqrfboard/book/examples/example-standardBinOutput/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>IQRFBB-10</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body class="homepage">

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">IQRFBB-10</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../..">GettingStarted</a>
                            </li>
                            <li >
                                <a href="../../IQRFBB10-Datasheet/">Datasheet</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">IQRF Network <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../SetupIqrfNetwork/">Setup IQRF Network</a>
</li>
                                    
<li >
    <a href="../../IqrfGatewayDaemon/">IQRF Gateway Daemon</a>
</li>
                                </ul>
                            </li>
                            <li >
                                <a href="../">Examples</a>
                            </li>
                            <li >
                                <a href="../../About/">About</a>
                            </li>
                            <li >
                                <a href="https://github.com/logimic/iqrfboard">GitHub Repo</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#standard-binary-output">Standard Binary Output</a></li>
            <li><a href="#links">Links</a></li>
            <li><a href="#prerequisities">Prerequisities</a></li>
            <li><a href="#hardware-wiring">Hardware wiring</a></li>
            <li><a href="#software-in-tr-module">Software in TR module</a></li>
            <li><a href="#api-json-message">API JSON message</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="standard-binary-output">Standard Binary Output</h1>
<p>This example shows how to create "Standard Binary Output" e.g. relay which will be  immediately recognized and manageable from IOT world thanks to gateways and standardization.</p>
<p>Standardization does not limit your hardware creativity, your light can be whatever you connect. The software in TR module makes connection with API. In following we will show how to implement two lights on the one board. The lights will be LED2 and LED3.</p>
<h2 id="links">Links</h2>
<ul>
<li><a href="../../IQRFBB10-Datasheet/">IQRFBB-10 Datasheet</a></li>
<li><a href="https://docs.iqrfsdk.org/iqrf-gateway-daemon/index.html">IQRF Gateway Daemon Documentation</a></li>
<li><a href="https://www.iqrfalliance.org/techDocs/">IQRF Standards</a></li>
</ul>
<h2 id="prerequisities">Prerequisities</h2>
<ol>
<li><strong>IQRFBB-10</strong> bonded in working IQRF network. More in <a href="../..">Getting Started</a></li>
<li><strong>IQRF Gateway Daemon</strong> working. More in <a href="../../IqrfGatewayDaemon/">IQRF Gateway Daemon</a></li>
<li><strong>Python 3.6 with WebSockets module</strong>. More in <a href="../../IqrfGatewayDaemon/#python-websocket-example">Python WebSockets example</a></li>
</ol>
<h2 id="hardware-wiring">Hardware wiring</h2>
<p><img alt="" src="../../files/datasheet/layout.png" /></p>
<p>No hardware wiring needed, lights will be demonstrated by LED2 and LED3.</p>
<h2 id="software-in-tr-module">Software in TR module</h2>
<p>The <a href="example-standardLight.c">example-standardLight.c</a> implements two lights on LED2 and LED3 outputs.
Please load this "Custom DPA Handler" to TR module on board. <a href="../../SetupIqrfNetwork/#load-custom-dpa-handler">Load Custom DPA Handler</a> manual.</p>
<h2 id="api-json-message">API JSON message</h2>
<p>Since we implemented standard light we can use standardized JSON messages for <a href="https://docs.iqrfsdk.org/iqrf-gateway-daemon/api.html#light">management of Lights</a> via JSON API of gateways.</p>
<h4 id="python-code">Python code</h4>
<p>The <a href="example-standardLight.py">example-standardLight.py</a> turns RED LED on, waits 2 seconds, then turns RED LED off and GREEN LED on, then after 2 seconds turns GREEN LED off.</p>
<pre><code class="py">#
# Copyright 2018 Logimic,s.r.o.
# www.logimic.com
#
# Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# Websockets led-on-off.py
import asyncio
import websockets
import json
import time

# This is IQRFBB-10 node address in IQRF network
boardAddr = 3

# JSON messages by &quot;https://docs.iqrfsdk.org/iqrf-gateway-daemon/api.html&quot;
LIGHT_ENUM = {
  &quot;mType&quot;: &quot;iqrfLight_Enumerate&quot;,
  &quot;data&quot;: {
    &quot;msgId&quot;: &quot;testEmbedLight&quot;,
    &quot;req&quot;: {
      &quot;nAdr&quot;: boardAddr,
      &quot;param&quot;: {}
    },
    &quot;returnVerbose&quot;: True
  }
}

LIGHT1_ON = {
  &quot;mType&quot;: &quot;iqrfLight_SetPower&quot;,
  &quot;data&quot;: {
    &quot;msgId&quot;: &quot;testEmbedLight&quot;,
    &quot;req&quot;: {
      &quot;nAdr&quot;: boardAddr,
      &quot;param&quot;: {
        &quot;lights&quot;: [
          {
            &quot;index&quot;: 0,
            &quot;power&quot;: 100
          }
        ]
      }
    },
    &quot;returnVerbose&quot;: True
  }
}

LIGHT1_OFF = {
  &quot;mType&quot;: &quot;iqrfLight_SetPower&quot;,
  &quot;data&quot;: {
    &quot;msgId&quot;: &quot;testEmbedLight&quot;,
    &quot;req&quot;: {
      &quot;nAdr&quot;: boardAddr,
      &quot;param&quot;: {
        &quot;lights&quot;: [
          {
            &quot;index&quot;: 0,
            &quot;power&quot;: 0
          }
        ]
      }
    },
    &quot;returnVerbose&quot;: True
  }
}

LIGHT2_ON = {
  &quot;mType&quot;: &quot;iqrfLight_SetPower&quot;,
  &quot;data&quot;: {
    &quot;msgId&quot;: &quot;testEmbedLight&quot;,
    &quot;req&quot;: {
      &quot;nAdr&quot;: boardAddr,
      &quot;param&quot;: {
        &quot;lights&quot;: [
          {
            &quot;index&quot;: 1,
            &quot;power&quot;: 100
          }
        ]
      }
    },
    &quot;returnVerbose&quot;: True
  }
}

LIGHT2_OFF = {
  &quot;mType&quot;: &quot;iqrfLight_SetPower&quot;,
  &quot;data&quot;: {
    &quot;msgId&quot;: &quot;testEmbedLight&quot;,
    &quot;req&quot;: {
      &quot;nAdr&quot;: boardAddr,
      &quot;param&quot;: {
        &quot;lights&quot;: [
          {
            &quot;index&quot;: 1,
            &quot;power&quot;: 0
          }
        ]
      }
    },
    &quot;returnVerbose&quot;: True
  }
}

async def hello():
    # Connect websockets
    async with websockets.connect(
            'ws://localhost:1338') as websocket:

        # List Lights...
        await websocket.send(json.dumps(LIGHT_ENUM))
        print(f&quot;Sent &gt; {LIGHT_ENUM}&quot;)

        response = await websocket.recv()
        print(f&quot;Received &lt; {response}&quot;)         

        data = json.loads(response)
        numLight = data[&quot;data&quot;][&quot;rsp&quot;][&quot;result&quot;][&quot;lights&quot;]

        print(&quot;-------------------------------------&quot;)
        print(f&quot;Node has implemented {numLight} ligts!&quot;)
        print(&quot;-------------------------------------&quot;)
        print(&quot;wait...&quot;)

        # Wait 3 sec
        time.sleep(3)

        # RED LED ON
        await websocket.send(json.dumps(LIGHT1_ON))
        print(f&quot;Sent &gt; {LIGHT1_ON}&quot;)

        response = await websocket.recv()
        print(f&quot;Received &lt; {response}&quot;)

        # Wait 2 sec
        time.sleep(2)

        # RED LED OFF
        await websocket.send(json.dumps(LIGHT1_OFF))
        print(f&quot;Sent &gt; {LIGHT1_OFF}&quot;)

        response = await websocket.recv()
        print(f&quot;Received &lt; {response}&quot;)        

        # GREEN LED ON
        await websocket.send(json.dumps(LIGHT2_ON))
        print(f&quot;Sent &gt; {LIGHT2_ON}&quot;)

        response = await websocket.recv()
        print(f&quot;Received &lt; {response}&quot;)        

        # Wait 2 sec
        time.sleep(2)

        # GREEN LED OFF
        await websocket.send(json.dumps(LIGHT2_OFF))
        print(f&quot;Sent &gt; {LIGHT2_OFF}&quot;)

        response = await websocket.recv()
        print(f&quot;Received &lt; {response}&quot;)            

asyncio.get_event_loop().run_until_complete(hello())
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright 2018, All rights reserved, Logimic, s.r.o.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

<!--
MkDocs version : 1.0.4
Build Date UTC : 2019-01-05 09:56:04
-->
